<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>周报生成器</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
        }
        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .input-section {
            flex: 1;
            background-color: #ffffff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: 20px;
            margin-right: 20px;
        }
        .preview-section {
            flex: 1;
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }
        h1 {
            text-align: center;
            color: #3498db;
            margin-bottom: 20px;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        label {
            display: inline-block;
            margin-top: 10px;
            color: #2c3e50;
            margin-right: 10px;
        }
        input[type="text"], input[type="date"], textarea, select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .date-inputs {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-bottom: 20px;
        }
        .date-input {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }
        .date-input label {
            margin-right: 10px;
            white-space: nowrap;
        }
        .date-input input[type="date"] {
            width: 180px; /* Increased width */
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            background-color: #434343;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            margin-top: 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            table-layout: fixed; /* Add this line */
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            word-wrap: break-word; /* Add this line */
            overflow-wrap: break-word; /* Add this line */
        }
        .preview-content table {
            table-layout: fixed;
        }
        .preview-content td {
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Adjust column widths */
        .preview-content th:nth-child(1),
        .preview-content td:nth-child(1) {
            width: 5%;
        }
        .preview-content th:nth-child(2),
        .preview-content td:nth-child(2) {
            width: 15%;
        }
        .preview-content th:nth-child(3),
        .preview-content td:nth-child(3) {
            width: 30%;
        }
        .preview-content th:nth-child(4),
        .preview-content td:nth-child(4) {
            width: 15%;
        }
        .preview-content th:nth-child(5),
        .preview-content td:nth-child(5) {
            width: 35%;
        }
        th {
            background-color: #f2f2f2;
            color: #2c3e50;
        }
        .preview-content {
            background-color: #ffffff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: 20px;
        }
        /* Preview styles */
        .preview-content .header_this_week,
        .preview-content .header_next_week {
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 8px 8px 0 0;
        }
        .preview-content .header_this_week {
            background-color: #3498db;
        }
        .preview-content .header_next_week {
            background-color: #2c3e50;
        }
        .preview-content h1 {
            margin: 0;
            font-size: 24px;
            color: white;
        }
        .preview-content .date {
            font-style: italic;
            margin-top: 5px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }
        .preview-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .preview-content th, .preview-content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        .preview-content th {
            background-color: #f2f2f2;
            font-weight: bold;
            color: #2c3e50;
        }
        .status {
            font-weight: bold;
            padding: 3px 6px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            font-size: 0.8em;
            white-space: nowrap;
        }
        .status::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 4px;
            flex-shrink: 0;
        }
        .status-not-started { color: #777; background-color: #f1f1f1; }
        .status-not-started::before { background-color: #777; }
        .status-in-progress { color: #0056b3; background-color: #e6f3ff; }
        .status-in-progress::before { background-color: #0056b3; }
        .status-completed { color: #28a745; background-color: #e6fff0; }
        .status-completed::before { background-color: #28a745; }
        .status-paused { color: #ffa500; background-color: #fff5e6; }
        .status-paused::before { background-color: #ffa500; }
        .status-overdue { color: #dc3545; background-color: #ffe6e6; }
        .status-overdue::before { background-color: #dc3545; }

        #thisWeekTable th:nth-child(1),
        #thisWeekTable td:nth-child(1) {
            width: 5%;
        }
        #thisWeekTable th:nth-child(2),
        #thisWeekTable td:nth-child(2) {
            width: 15%;
        }
        #thisWeekTable th:nth-child(3),
        #thisWeekTable td:nth-child(3) {
            width: 25%;
        }
        #thisWeekTable th:nth-child(4),
        #thisWeekTable td:nth-child(4) {
            width: 15%;
        }
        #thisWeekTable th:nth-child(5),
        #thisWeekTable td:nth-child(5) {
            width: 30%;
        }
        #thisWeekTable th:nth-child(6),
        #thisWeekTable td:nth-child(6) {
            width: 10%;
        }

        #nextWeekTable th:nth-child(1),
        #nextWeekTable td:nth-child(1) {
            width: 5%;
        }
        #nextWeekTable th:nth-child(2),
        #nextWeekTable td:nth-child(2) {
            width: 20%;
        }
        #nextWeekTable th:nth-child(3),
        #nextWeekTable td:nth-child(3) {
            width: 65%;
        }
        #nextWeekTable th:nth-child(4),
        #nextWeekTable td:nth-child(4) {
            width: 10%;
        }

        /* Adjust these styles for better text wrapping */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0px;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            word-wrap: break-word;
            overflow-wrap: break-word;
            vertical-align: top;
        }
        textarea {
            width: 100%;
            resize: vertical;
            min-height: 60px;
        }
        
        /* Adjust column widths for input tables */
        #thisWeekTable th:nth-child(1), #thisWeekTable td:nth-child(1),
        #nextWeekTable th:nth-child(1), #nextWeekTable td:nth-child(1) { width: 5%; }
        #thisWeekTable th:nth-child(2), #thisWeekTable td:nth-child(2),
        #nextWeekTable th:nth-child(2), #nextWeekTable td:nth-child(2) { width: 15%; }
        #thisWeekTable th:nth-child(3), #thisWeekTable td:nth-child(3) { width: 25%; }
        #thisWeekTable th:nth-child(4), #thisWeekTable td:nth-child(4) { width: 15%; }
        #thisWeekTable th:nth-child(5), #thisWeekTable td:nth-child(5) { width: 30%; }
        #thisWeekTable th:nth-child(6), #thisWeekTable td:nth-child(6) { width: 10%; }
        #nextWeekTable th:nth-child(3), #nextWeekTable td:nth-child(3) { width: 70%; }
        #nextWeekTable th:nth-child(4), #nextWeekTable td:nth-child(4) { width: 10%; }

        /* Adjust preview styles */
        .preview-content table {
            table-layout: fixed;
        }
        .preview-content th, .preview-content td {
            word-wrap: break-word;
            overflow-wrap: break-word;
            vertical-align: top;
        }
        .preview-content th:nth-child(1),
        .preview-content td:nth-child(1) { width: 5%; }
        .preview-content th:nth-child(2),
        .preview-content td:nth-child(2) { width: 15%; }
        .preview-content th:nth-child(3),
        .preview-content td:nth-child(3) { width: 30%; }
        .preview-content th:nth-child(4),
        .preview-content td:nth-child(4) { width: 15%; }
        .preview-content th:nth-child(5),
        .preview-content td:nth-child(5) { width: 35%; }

        .date-inputs {
            margin-bottom: 20px;
        }
        #dateRange {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        .date-picker-container {
            display: none;
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 10px;
            z-index: 1000;
            width: 500px;
        }
        .date-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .date-picker-body {
            display: flex;
            justify-content: space-between;
        }
        .month {
            width: 48%;
        }
        .month-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .weekdays, .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
        }
        .weekdays div {
            font-weight: bold;
            padding: 5px;
        }
        .days div {
            padding: 5px;
            cursor: pointer;
            border-radius: 50%;
        }
        .days div:hover {
            background-color: #f0f0f0;
        }
        .selected-start, .selected-end {
            background-color: #3498db;
            color: white;
        }
        .in-range {
            background-color: #e6f3ff;
        }
        .prev-month, .next-month {
            cursor: pointer;
            font-size: 18px;
        }

        /* Add these new styles */
        #generateMemoBtn {
            display: none; /* This hides the "生成备忘录" button */
        }

        #copyHtmlBtn {
            font-size: 16px;
            padding: 12px 24px;
            background-color: #4CAF50; /* An elegant, modern green */
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #copyHtmlBtn:hover {
            background-color: #45a049; /* Slightly darker shade for hover effect */
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="input-section">
            <h1>周报生成器</h1>
            <form id="memoForm">
                <!-- Replace the date picker input with these two date inputs -->
                <div class="date-inputs">
                    <div class="date-input">
                        <label for="startDate">开始日期:</label>
                        <input type="date" id="startDate" required onchange="updatePreview()">
                    </div>
                    <div class="date-input">
                        <label for="endDate">结束日期:</label>
                        <input type="date" id="endDate" required onchange="updatePreview()">
                    </div>
                </div>
                
                <h2>本周工作内容</h2>
                <table id="thisWeekTable">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>项目</th>
                            <th>任务</th>
                            <th>完成情况</th>
                            <th>进展说明</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be added dynamically -->
                    </tbody>
                </table>
                <button type="button" onclick="addRow('thisWeekTable')">添加行</button>
                
                <h2>下周工作计划</h2>
                <table id="nextWeekTable">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>项目</th>
                            <th>计划说明</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows will be added dynamically -->
                    </tbody>
                </table>
                <button type="button" onclick="addRow('nextWeekTable')">添加行</button>
                
                <button id="generateMemoBtn" type="button" onclick="generateMemo()">生成备忘录</button>
            </form>
        </div>
        <div class="preview-section">
            <h2>预览</h2>
            <div id="preview" class="preview-content"></div>
            <button id="copyHtmlBtn" type="button" onclick="copyHTML()">复制 HTML</button>
            <span id="copyHint" style="display: none; color: green; margin-left: 10px;">已复制到剪贴板</span>
        </div>
    </div>

    <script>
        function addRow(tableId) {
            const table = document.getElementById(tableId);
            const newRow = table.insertRow(-1);
            const rowCount = table.rows.length - 1;
            
            if (tableId === 'thisWeekTable') {
                newRow.innerHTML = `
                    <td>${rowCount}</td>
                    <td><input type="text" placeholder="项目" oninput="updatePreview()"></td>
                    <td><textarea placeholder="任务" rows="2" oninput="updatePreview()"></textarea></td>
                    <td>
                        <select onchange="updatePreview()">
                            <option value="not-started">未开始</option>
                            <option value="in-progress">进行中</option>
                            <option value="completed">已完成</option>
                            <option value="paused">暂停</option>
                            <option value="overdue">逾期</option>
                        </select>
                    </td>
                    <td><textarea placeholder="进展说明" rows="2" oninput="updatePreview()"></textarea></td>
                    <td><button type="button" onclick="deleteRow(this)">删除</button></td>
                `;
            } else {
                newRow.innerHTML = `
                    <td>${rowCount}</td>
                    <td><input type="text" placeholder="项目" oninput="updatePreview()"></td>
                    <td><textarea placeholder="计划说明" rows="2" oninput="updatePreview()"></textarea></td>
                    <td><button type="button" onclick="deleteRow(this)">删除</button></td>
                `;
            }
            updatePreview();
        }

        function deleteRow(btn) {
            const row = btn.parentNode.parentNode;
            const tbody = row.parentNode;
            tbody.removeChild(row);
            updateRowNumbers(tbody);
            console.log('Row deleted, updating preview...');
            updatePreview();
        }

        function updateRowNumbers(tbody) {
            const rows = tbody.getElementsByTagName('tr');
            for (let i = 0; i < rows.length; i++) {
                // 更新显示的序号
                rows[i].cells[0].textContent = i + 1;
                // 更新输入字段的序号（如果存在）
                const input = rows[i].cells[0].querySelector('input[type="number"]');
                if (input) {
                    input.value = i + 1;
                }
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
        }

        function updatePreview() {
            console.log('Updating preview...');
            const startDate = formatDate(document.getElementById('startDate').value);
            const endDate = formatDate(document.getElementById('endDate').value);
            const thisWeekContent = generateTableContent('thisWeekTable', true);
            const nextWeekContent = generateTableContent('nextWeekTable', false);

            console.log('This week content:', thisWeekContent);
            console.log('Next week content:', nextWeekContent);

            const previewHTML = `
                <div class="header_this_week">
                    <h1>本周工作内容</h1>
                    <div class="date">${startDate} ~ ${endDate}</div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>项目</th>
                            <th>任务</th>
                            <th>完成情况</th>
                            <th>进展说明</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${thisWeekContent}
                    </tbody>
                </table>
                <div class="header_next_week">
                    <h1>下周工作计划</h1>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>项目</th>
                            <th>计划说明</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${nextWeekContent}
                    </tbody>
                </table>
            `;

            document.getElementById('preview').innerHTML = previewHTML;
            console.log('Preview updated');
        }

        function generateMemo() {
            // This function can be kept for future use if needed, but it won't be visible to users
            const startDate = formatDate(document.getElementById('startDate').value);
            const endDate = formatDate(document.getElementById('endDate').value);
            const thisWeekContent = generateTableContent('thisWeekTable', true);
            const nextWeekContent = generateTableContent('nextWeekTable', false);

            const memoHTML = `
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>本周工作内容</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background-color: #f7f7f7;
        }
        .container {
            max-width: 700px;
            margin: 0 auto;
            background-color: #ffffff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        .header_this_week, .header_next_week {
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header_this_week {
            background-color: #3498db;
        }
        .header_next_week {
            background-color: #2c3e50;
        }
        h1 {
            margin: 0;
            font-size: 24px;
        }
        .date {
            font-style: italic;
            margin-top: 5px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: fixed;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            word-wrap: break-word;
            overflow-wrap: break-word;
            vertical-align: top;
        }
        th:nth-child(1), td:nth-child(1) { width: 5%; }
        th:nth-child(2), td:nth-child(2) { width: 15%; }
        th:nth-child(3), td:nth-child(3) { width: 30%; }
        th:nth-child(4), td:nth-child(4) { width: 15%; }
        th:nth-child(5), td:nth-child(5) { width: 35%; }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            color: #2c3e50;
        }
        tr:last-child td {
            border-bottom: none;
        }
        .status {
            font-weight: bold;
            padding: 3px 6px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            font-size: 0.8em;
            white-space: nowrap;
        }
        .status::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 4px;
            flex-shrink: 0;
        }
        .status-not-started { color: #777; background-color: #f1f1f1; }
        .status-not-started::before { background-color: #777; }
        .status-in-progress { color: #0056b3; background-color: #e6f3ff; }
        .status-in-progress::before { background-color: #0056b3; }
        .status-completed { color: #28a745; background-color: #e6fff0; }
        .status-completed::before { background-color: #28a745; }
        .status-paused { color: #ffa500; background-color: #fff5e6; }
        .status-paused::before { background-color: #ffa500; }
        .status-overdue { color: #dc3545; background-color: #ffe6e6; }
        .status-overdue::before { background-color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header_this_week">
            <h1>本周工作内容</h1>
            <div class="date">${startDate} ~ ${endDate}</div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>序号</th>
                    <th>项目</th>
                    <th>任务</th>
                    <th>完成情况</th>
                    <th>进展说明</th>
                </tr>
            </thead>
            <tbody>
                ${thisWeekContent}
            </tbody>
        </table>
        <div class="header_next_week">
            <h1>下周工作计划</h1>
        </div>
        <table>
            <thead>
                <tr>
                    <th>序号</th>
                    <th>项目</th>
                    <th>计划说明</th>
                </tr>
            </thead>
            <tbody>
                ${nextWeekContent}
            </tbody>
        </table> 
    </div>
</body>
</html>
            `;

            // Create a Blob with the HTML content
            const blob = new Blob([memoHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            // Create a download link and trigger the download
            const a = document.createElement('a');
            a.href = url;
            a.download = 'weekly_memo.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function generateTableContent(tableId, includeStatus) {
            const table = document.getElementById(tableId);
            let content = '';
            
            const rows = table.getElementsByTagName('tr');
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (includeStatus) {
                    const status = row.cells[3].querySelector('select').value;
                    const statusClass = `status-${status}`;
                    let statusText;
                    switch(status) {
                        case 'not-started': statusText = '未开始'; break;
                        case 'in-progress': statusText = '进行中'; break;
                        case 'completed': statusText = '已完成'; break;
                        case 'paused': statusText = '暂停'; break;
                        case 'overdue': statusText = '逾期'; break;
                    }
                    content += `
                <tr>
                    <td data-label="序号">${i}</td>
                    <td data-label="项目">${row.cells[1].querySelector('input').value}</td>
                    <td data-label="任务">${row.cells[2].querySelector('textarea').value.replace(/\n/g, '<br>')}</td>
                    <td data-label="完成情况"><span class="status ${statusClass}">${statusText}</span></td>
                    <td data-label="进展说明">${row.cells[4].querySelector('textarea').value.replace(/\n/g, '<br>')}</td>
                </tr>
                    `;
                } else {
                    content += `
                <tr>
                    <td data-label="序号">${i}</td>
                    <td data-label="项目">${row.cells[1].querySelector('input').value}</td>
                    <td data-label="计划说明">${row.cells[2].querySelector('textarea').value.replace(/\n/g, '<br>')}</td>
                </tr>
                    `;
                }
            }
            
            return content;
        }

        function copyHTML() {
            const startDate = formatDate(document.getElementById('startDate').value);
            const endDate = formatDate(document.getElementById('endDate').value);
            const thisWeekContent = generateTableContent('thisWeekTable', true);
            const nextWeekContent = generateTableContent('nextWeekTable', false);

            const memoHTML = `
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>本周工作内容</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background-color: #f7f7f7;
        }
        .container {
            max-width: 700px;
            margin: 0 auto;
            background-color: #ffffff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        .header_this_week, .header_next_week {
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header_this_week {
            background-color: #3498db;
        }
        .header_next_week {
            background-color: #2c3e50;
        }
        h1 {
            margin: 0;
            font-size: 24px;
        }
        .date {
            font-style: italic;
            margin-top: 5px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: fixed;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            word-wrap: break-word;
            overflow-wrap: break-word;
            vertical-align: top;
        }
        th:nth-child(1), td:nth-child(1) { width: 5%; }
        th:nth-child(2), td:nth-child(2) { width: 15%; }
        th:nth-child(3), td:nth-child(3) { width: 30%; }
        th:nth-child(4), td:nth-child(4) { width: 15%; }
        th:nth-child(5), td:nth-child(5) { width: 35%; }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            color: #2c3e50;
        }
        tr:last-child td {
            border-bottom: none;
        }
        .status {
            font-weight: bold;
            padding: 3px 6px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            font-size: 0.8em;
            white-space: nowrap;
        }
        .status::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 4px;
            flex-shrink: 0;
        }
        .status-not-started { color: #777; background-color: #f1f1f1; }
        .status-not-started::before { background-color: #777; }
        .status-in-progress { color: #0056b3; background-color: #e6f3ff; }
        .status-in-progress::before { background-color: #0056b3; }
        .status-completed { color: #28a745; background-color: #e6fff0; }
        .status-completed::before { background-color: #28a745; }
        .status-paused { color: #ffa500; background-color: #fff5e6; }
        .status-paused::before { background-color: #ffa500; }
        .status-overdue { color: #dc3545; background-color: #ffe6e6; }
        .status-overdue::before { background-color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header_this_week">
            <h1>本周工作内容</h1>
            <div class="date">${startDate} ~ ${endDate}</div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>序号</th>
                    <th>项目</th>
                    <th>任务</th>
                    <th>完成情况</th>
                    <th>进展说明</th>
                </tr>
            </thead>
            <tbody>
                ${thisWeekContent}
            </tbody>
        </table>
        <div class="header_next_week">
            <h1>下周工作计划</h1>
        </div>
        <table>
            <thead>
                <tr>
                    <th>序号</th>
                    <th>项目</th>
                    <th>计划说明</th>
                </tr>
            </thead>
            <tbody>
                ${nextWeekContent}
            </tbody>
        </table> 
    </div>
</body>
</html>
            `;

            // Copy the HTML to clipboard
            navigator.clipboard.writeText(memoHTML).then(() => {
                // Show the copy hint
                const copyHint = document.getElementById('copyHint');
                copyHint.style.display = 'inline';
                
                // Hide the hint after 1 second (changed from 2 seconds)
                setTimeout(() => {
                    copyHint.style.display = 'none';
                }, 1000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }

        // Add initial rows and update preview
        addRow('thisWeekTable');
        addRow('nextWeekTable');
        updatePreview();
    </script>
</body>
</html>
